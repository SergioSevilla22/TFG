<div class="perfil-container">
  <div class="perfil-image">
    <div class="foto-area">
      <img [src]="getProfileImage()" alt="Foto de perfil" class="foto-perfil-redonda" />
  
      <!-- Botones para editar/guardar la foto -->
      <div class="acciones-foto">
        <button class="btn-editar-foto" (click)="fileInput.click()">Editar foto</button>
  
        <!-- Solo aparece el botón "Guardar foto" si se ha seleccionado una nueva -->
        <button
          *ngIf="selectedFile"
          class="btn-guardar-foto"
          (click)="guardarSoloFoto()"
          [disabled]="loading"
        >
          Guardar foto
        </button>
      </div>
  
      <input
        type="file"
        #fileInput
        style="display: none"
        (change)="onFileChange($event)"
        accept="image/*"
      />
    </div>
  </div>

  <!-- Contenedor principal -->
  <div class="perfil-form-container">
    <div class="perfil-message">
      <h2>Mi Perfil</h2>
      <p>Consulta y edita tu información personal</p>
    </div>

    <div *ngIf="user; else noUser" class="perfil-card">

      <div class="info">
        <ng-container *ngIf="!editMode; else editForm">
          <p><strong>DNI:</strong> {{ user.DNI }}</p>
          <p><strong>Nombre:</strong> {{ user.nombre }}</p>
          <p><strong>Email:</strong> {{ user.email }}</p>
          <p><strong>Teléfono:</strong> {{ user.telefono }}</p>
          <p><strong>Rol:</strong> {{ user.Rol }}</p>
          <div class="actions">
            <button (click)="toggleEdit()">Editar</button>
            <button class="btn-logout" (click)="logout()">Cerrar sesión</button>
          </div>
        </ng-container>

        <ng-template #editForm>
          <label>Nombre:
            <input [(ngModel)]="user.nombre" />
          </label>
          <label>Email:
            <input [(ngModel)]="user.email" />
          </label>
          <label>Teléfono:
            <input [(ngModel)]="user.telefono" />
          </label>
          <label>Rol:
            <select>
              <option value="jugador">Jugador</option>
              <option value="entrenador">Entrenador</option>
              <option value="admin">Administrador</option>
            </select>
          </label>

          <div class="actions">
            <button (click)="guardarCambios()" [disabled]="loading">Guardar</button>
            <button (click)="toggleEdit()">Cancelar</button>
          </div>
          <p *ngIf="errorMsg" class="error">{{ errorMsg }}</p>
        </ng-template>
      </div>
    </div>

    <ng-template #noUser>
      <p>No hay usuario logueado.</p>
    </ng-template>
  </div>
</div>
