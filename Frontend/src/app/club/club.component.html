<app-header></app-header>

<div class="club-wrapper" *ngIf="!loading; else loadingTpl">

  <!-- =========================
       CABECERA DEL CLUB
  ========================== -->
  <div class="club-header">
    <div class="club-header-left">
      <img
      *ngIf="club?.escudo"
      [src]="'http://localhost:3000' + club.escudo"
      class="escudo"
      />

      <div>
        <h1>{{ club?.nombre }}</h1>
        <p class="club-location">
          {{ club?.poblacion }}, {{ club?.provincia }}
        </p>
      </div>
    </div>
  </div>

  <!-- =========================
       KPIs / CONTADORES
  ========================== -->
  <div class="kpi-grid" *ngIf="resumen">

    <div class="kpi-card">
      <h4>Equipos</h4>
      <span>{{ resumen.totalEquipos }}</span>
    </div>

    <div class="kpi-card">
      <h4>Jugadores</h4>
      <span>{{ resumen.totalJugadores }}</span>
    </div>

    <div class="kpi-card">
      <h4>Entrenadores</h4>
      <span>{{ resumen.totalEntrenadores }}</span>
    </div>

  </div>

  <!-- =========================
       BUSCADOR DE EQUIPOS
  ========================== -->
  <div class="filters-card">

    <h3>Buscar equipos del club</h3>

    <div class="filters-grid">
      <input
        type="text"
        placeholder="Nombre del equipo"
        [(ngModel)]="filtrosEquipos.nombre"
        (input)="onInputChange()"
      />

      <input
        type="text"
        placeholder="Categor√≠a"
        [(ngModel)]="filtrosEquipos.categoria"
        (input)="onInputChange()"
      />

      <input
        type="text"
        placeholder="Temporada"
        [(ngModel)]="filtrosEquipos.temporada"
        (input)="onInputChange()"
      />

      <button class="btn-search" (click)="buscarEquipos()">
        Buscar
      </button>
    </div>

  </div>

  <!-- =========================
       LISTADO DE EQUIPOS
  ========================== -->
  <div class="info-section">

    <div class="info-card equipos-card">

      <div class="equipos-header">
        <h3>Equipos del Club</h3>
      </div>

      <div class="equipo-list" *ngIf="buscado && equiposFiltrados.length > 0">
        <div
          class="equipo-item"
          *ngFor="let equipo of equiposFiltrados"
          (click)="abrirEquipo(equipo.id)"
        >
          <h4>{{ equipo.nombre }}</h4>
          <p>{{ equipo.categoria }} ¬∑ {{ equipo.temporada }}</p>
        </div>
      </div>

      <p class="empty" *ngIf="!buscado">
        Usa el buscador de arriba para encontrar equipos del club
      </p>
      
      <!-- üëâ B√∫squeda sin resultados -->
      <p class="empty" *ngIf="buscado && equiposFiltrados.length === 0">
        No hay equipos que coincidan con la b√∫squeda
      </p>

    </div>

    <!-- =========================
         TARJETA INFO CLUB
    ========================== -->
    <div class="info-card clickable" (click)="editarClub()">
      <h3>Informaci√≥n del Club</h3>

      <p><strong>Email:</strong> {{ club?.email || 'N/A' }}</p>
      <p><strong>Tel√©fono:</strong> {{ club?.telefono || 'N/A' }}</p>
      <p><strong>Direcci√≥n:</strong> {{ club?.direccion || 'N/A' }}</p>
      <p><strong>C√≥digo Postal:</strong> {{ club?.codigo_postal || 'N/A' }}</p>

      <div class="arrow">‚ûú</div>
    </div>

  </div>

  <!-- =========================
       ACCIONES
  ========================== -->
  <div class="club-actions">
    <button (click)="abrirModalTraspasos()">
      Gestionar usuarios / traspasos
    </button>

    <button class="secondary" (click)="abrirEquiposClub()">
      Crear / gestionar equipos
    </button>
  </div>

</div>

<ng-template #loadingTpl>
  <p class="loading">Cargando datos...</p>
</ng-template>
