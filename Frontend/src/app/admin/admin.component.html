<app-header></app-header>

<div class="admin-wrapper">
  <div class="admin-container">

    <h2>Panel de Administración</h2>

    <!-- TABS -->
    <div class="tabs">
      <button type="button"
              [class.active]="activeTab === 'eliminar'"
              (click)="activeTab = 'eliminar'">
        Eliminar Usuario
      </button>

      <button type="button"
              [class.active]="activeTab === 'roles'"
              (click)="activeTab = 'roles'">
        Gestión de Roles
      </button>

      <button type="button"
              [class.active]="activeTab === 'registrar'"
              (click)="activeTab = 'registrar'">
        Registrar
      </button>
    </div>

    <!-- TAB: Eliminar Usuario -->
    <div class="tab-content" *ngIf="activeTab === 'eliminar'">
      <h3>Eliminar Usuario</h3>

      <input type="text" [(ngModel)]="dniToDelete" placeholder="Introduce DNI" />

      <button type="button" (click)="eliminarUsuario()">Eliminar</button>

      <p class="resultado">{{ resultado }}</p>
    </div>

    <!-- TAB: Gestión de Roles -->
    <div class="tab-content" *ngIf="activeTab === 'roles'">
      <h3>Buscar Usuario</h3>

      <input 
        type="text"
        class="input-dni"
        [(ngModel)]="dniBusqueda"
        (ngModelChange)="onDniChange()"
        placeholder="Introduce DNI"
      />

      <button type="button" (click)="buscarUsuario()">Buscar</button>

      <p class="resultado">{{ resultadoBusqueda }}</p>

      <!-- Tarjeta del usuario encontrado -->
      <div *ngIf="usuarioEncontrado" class="user-card">
        <h4>{{ usuarioEncontrado.nombre }}</h4>

        <p><strong>DNI:</strong> {{ usuarioEncontrado.DNI }}</p>
        <p><strong>Email:</strong> {{ usuarioEncontrado.email }}</p>
        <p><strong>Teléfono:</strong> {{ usuarioEncontrado.telefono }}</p>
        <p><strong>Rol actual:</strong> {{ usuarioEncontrado.Rol }}</p>

        <label>Nuevo Rol:</label>

        <div class="rol-selector-container">
          <select [(ngModel)]="nuevoRol" class="rol-selector">
            <option value="">Seleccionar...</option>
            <option value="jugador">Jugador</option>
            <option value="entrenador">Entrenador</option>
            <option value="tutor">Tutor</option>
          </select>
        </div>

        <button type="button" (click)="cambiarRol()">Guardar Rol</button>

        <p class="resultado">{{ resultadoRol }}</p>
      </div>
    </div>
    
    <div class="tab-content" *ngIf="activeTab === 'registrar'">
      <div class="register-form-container">
        <div class="register-message">
          <h2>Registro de Usuario</h2>
          <p>Registra a los usuarios del club</p>
        </div>

        <form [formGroup]="RegisterForm" (ngSubmit)="onSubmit()" class="register-form">
          <label for="dni">DNI</label>
          <input id="dni" type="text" formControlName="DNI" />

          <label for="nombre">Nombre</label>
          <input id="nombre" type="text" formControlName="nombre" />

          <label for="email">Email</label>
          <input id="email" type="email" formControlName="email" />

          <label for="telefono">Teléfono</label>
          <input id="telefono" type="text" formControlName="telefono" />

          <label for="rol">Rol</label>
          <select id="rol" formControlName="Rol">
            <option value="usuario">Usuario</option>
            <option value="jugador">Jugador</option>
            <option value="entrenador">Entrenador</option>
          </select>

          <button type="submit">Registrar</button>
        </form>

        <hr />

        <div class="register-massive-container">
          <h3>Registro Masivo (CSV)</h3>
          <label for="csvFile">Selecciona archivo CSV</label>
          <input id="csvFile" type="file" (change)="onFileSelected($event)" accept=".csv" />
          <button type="button" (click)="uploadCSV()">Subir CSV</button>
        </div>
      </div>   
    </div>
  </div>
</div>
