<app-header></app-header>

<div class="admin-wrapper">
  <div class="admin-container">

    <h2>Panel de Administración</h2>

    <!-- TABS -->
    <div class="tabs">
      <button type="button"
              [class.active]="activeTab === 'eliminar'"
              (click)="activeTab = 'eliminar'">
        Eliminar Usuario
      </button>

      <button type="button"
              [class.active]="activeTab === 'roles'"
              (click)="activeTab = 'roles'">
        Gestión de Roles
      </button>

      <button type="button"
              [class.active]="activeTab === 'registrar'"
              (click)="activeTab = 'registrar'">
        Registrar
      </button>
    </div>

    <!-- TAB: Eliminar Usuario -->
    <div class="tab-content" *ngIf="activeTab === 'eliminar'">
      <h3>Eliminar Usuario</h3>

      <input type="text" [(ngModel)]="dniToDelete" placeholder="Introduce DNI" />

      <button type="button" (click)="eliminarUsuario()">Eliminar</button>

      <p class="resultado">{{ resultado }}</p>
    </div>

    <!-- TAB: Gestión de Roles -->
    <div class="tab-content" *ngIf="activeTab === 'roles'">
      <h3>Buscar Usuario</h3>

      <input 
        type="text"
        class="input-dni"
        [(ngModel)]="dniBusqueda"
        (ngModelChange)="onDniChange()"
        placeholder="Introduce DNI"
      />

      <button type="button" (click)="buscarUsuario()">Buscar</button>

      <p class="resultado">{{ resultadoBusqueda }}</p>

      <!-- Tarjeta del usuario encontrado -->
      <div *ngIf="usuarioEncontrado" class="user-card">
        <h4>{{ usuarioEncontrado.nombre }}</h4>

        <p><strong>DNI:</strong> {{ usuarioEncontrado.DNI }}</p>
        <p><strong>Email:</strong> {{ usuarioEncontrado.email }}</p>
        <p><strong>Teléfono:</strong> {{ usuarioEncontrado.telefono }}</p>
        <p><strong>Rol actual:</strong> {{ usuarioEncontrado.Rol }}</p>

        <label>Nuevo Rol:</label>

        <div class="rol-selector-container">
          <select [(ngModel)]="nuevoRol" class="rol-selector">
            <option value="">Seleccionar...</option>
            <option value="jugador">Jugador</option>
            <option value="entrenador">Entrenador</option>
            <option value="tutor">Tutor</option>
          </select>
        </div>

        <button type="button" (click)="cambiarRol()">Guardar Rol</button>

        <p class="resultado">{{ resultadoRol }}</p>
      </div>
    </div>
    
    <div class="tab-content" *ngIf="activeTab === 'registrar'">
      <div class="register-form-container">
    
        <div class="register-header">
          <h3>Registro de Usuario</h3>
          <p>Da de alta a jugadores, entrenadores y usuarios del club.</p>
        </div>
    
        <form [formGroup]="RegisterForm" (ngSubmit)="onSubmit()" class="register-form">
          <!-- Fila 1 -->
          <div class="form-row">
            <div class="form-group">
              <label for="dni">DNI</label>
              <input id="dni" type="text" formControlName="DNI" />
            </div>
    
            <div class="form-group">
              <label for="nombre">Nombre</label>
              <input id="nombre" type="text" formControlName="nombre" />
            </div>
          </div>
    
          <!-- Fila 2 -->
          <div class="form-row">
            <div class="form-group">
              <label for="email">Email</label>
              <input id="email" type="email" formControlName="email" />
            </div>
    
            <div class="form-group">
              <label for="telefono">Teléfono</label>
              <input id="telefono" type="text" formControlName="telefono" />
            </div>
          </div>
    
          <!-- Fila 3 -->
          <div class="form-row">
            <div class="form-group">
              <label for="rol">Rol</label>
              <select id="rol" formControlName="Rol">
                <option value="tutor">Tutor</option>
                <option value="jugador">Jugador</option>
                <option value="entrenador">Entrenador</option>
              </select>
            </div>
    
            <div class="btn-registrar">
              <button type="submit">Registrar</button>
            </div>
          </div>
        </form>
    
        <div class="register-massive-container">
          <h4>Registro Masivo (CSV)</h4>
          <p class="register-massive-text">
            Sube un archivo CSV para registrar varios miembros del club de una sola vez.
          </p>
    
          <div class="csv-row">
            <input
              id="csvFile"
              type="file"
              (change)="onFileSelected($event)"
              accept=".csv"
            />
            <div class="Massive-button">
              <button type="button" (click)="uploadCSV()">Subir CSV</button>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>
