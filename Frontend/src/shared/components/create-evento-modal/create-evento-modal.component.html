<div class="modal-header">
  <h2 mat-dialog-title>Nuevo Evento</h2>
  <p class="subtitle">Define los detalles de la actividad y gestiona la asistencia.</p>
</div>

<div mat-dialog-content class="modal-content">
  <div class="section-title">
    <mat-icon>event_note</mat-icon>
    <span>Detalles del Evento</span>
  </div>

  <div class="form-grid">
    <div class="field full-width">
      <label>T√≠tulo del Evento *</label>
      <input type="text" [(ngModel)]="evento.titulo" placeholder="Ej: Entrenamiento T√°ctico" class="custom-input">
    </div>

    <div class="field full-width">
      <label>Descripci√≥n</label>
      <textarea [(ngModel)]="evento.descripcion" rows="3" placeholder="Detalles adicionales, material necesario..." class="custom-input"></textarea>
    </div>

    <div class="field">
      <label>Tipo de Evento *</label>
      <div class="select-wrapper">
        <select [(ngModel)]="evento.tipo" class="custom-input">
          <option value="entrenamiento">‚öΩ Entrenamiento</option>
          <option value="partido">üèÜ Partido</option>
          <option value="reunion">üìã Reuni√≥n</option>
          <option value="otro">‚ú® Otro</option>
        </select>
      </div>
    </div>

    <div class="field">
      <label>Fecha y Hora Inicio *</label>
      <input type="datetime-local" [(ngModel)]="evento.fecha_inicio" class="custom-input">
    </div>

    <div class="field">
      <label>Fecha y Hora Fin *</label>
      <input type="datetime-local" [(ngModel)]="evento.fecha_fin" class="custom-input">
    </div>
  </div>

  <div class="section-title margin-top">
    <mat-icon>fact_check</mat-icon>
    <span>Ajustes de Asistencia</span>
  </div>

  <div class="field confirmation-toggle">
    <label class="toggle-container">
      <input type="checkbox" [(ngModel)]="evento.requiere_confirmacion" class="custom-checkbox">
      <span class="toggle-text">Este evento requiere confirmaci√≥n de los jugadores</span>
    </label>
  </div>

  <div class="conditional-section" *ngIf="evento.requiere_confirmacion">
    <div class="field">
      <label>Fecha L√≠mite para Confirmar *</label>
      <input type="datetime-local" [(ngModel)]="evento.fecha_limite_confirmacion" class="custom-input">
      <small class="helper-text">Pasada esta fecha, los jugadores no podr√°n responder.</small>
    </div>

    <div class="section-title margin-top-sm">
      <mat-icon>person_add</mat-icon>
      <span>Convocar Jugadores</span>
    </div>

    <div class="player-selection-container">
      <div class="player-list">
        <label class="player-row" *ngFor="let j of jugadores">
          <div class="player-info">
            <input
            type="checkbox"
            [checked]="seleccionados.has(j.DNI)"
            (change)="toggleJugador(j.DNI, $event)">
          
            
            <div class="avatar-mini">
              <img *ngIf="j.foto" [src]="'http://localhost:3000' + j.foto" alt="Foto" class="avatar-img">
              <span *ngIf="!j.foto">{{ j.nombre[0] | uppercase }}</span>
            </div>

            <span class="name">{{ j.nombre }}</span>
            <span class="dni-tag">{{ j.DNI }}</span>
          </div>
        </label>
      </div>
    </div>
  </div>

  <div class="error-container" *ngIf="mensaje">
    <mat-icon>error_outline</mat-icon>
    <span>{{ mensaje }}</span>
  </div>
</div>

<div mat-dialog-actions align="end" class="modal-actions">
  <button mat-button (click)="cerrar()" class="btn-cancel">Cancelar</button>
  <button mat-flat-button color="primary" [disabled]="loading" (click)="guardar()" class="btn-publish">
    <mat-icon *ngIf="!loading">add_task</mat-icon>
    {{ 
      loading 
        ? (modo === 'editar' ? 'Guardando...' : 'Creando...') 
        : (modo === 'editar' ? 'Guardar Cambios' : 'Crear Evento') 
    }}
  </button>
</div>